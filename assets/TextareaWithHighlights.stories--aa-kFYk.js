import{H as j}from"./index-i3TaiYjO.js";import{j as p}from"./jsx-runtime-vNq4Oc-g.js";import{r as o,R as z}from"./index-4g5l5LRQ.js";import"./_commonjsHelpers-4gQjN7DL.js";function P(n,i=null){const g=o.useRef(i);return o.useEffect(()=>{if(n)if(typeof n=="function"){n(g.current);return}else n.current=g.current}),g}const C=(n,i)=>o.useMemo(()=>{if(!i)return[];const{ranges:g,regexes:l,strings:h}=(Array.isArray(i)?typeof i[0]=="number"?[i]:i:[i]).reduce((e,t)=>(typeof t=="string"?e.strings.push(t):Array.isArray(t)&&typeof t[0]=="number"&&typeof t[1]=="number"?e.ranges.push(t):t instanceof RegExp&&e.regexes.push(t),e),{ranges:[],regexes:[],strings:[]});if(!g.length&&!l.length&&!h.length)return[];const f=[];for(let e=0;e<h.length;e++){let t=-1;for(;(t=n.indexOf(h[e],t+1))>=0;)f.push([t,t+h[e].length])}const x=[];for(let e=0;e<l.length;e++){const t=[];if(l[e].global){let a=-1,c;for(;(c=l[e].exec(n))!==null&&(!t.length||c.index>t[a][0]);)t.push([c.index,c.index+c[0].length]),a++}else{const a=l[e].exec(n);a&&t.push([a.index,a.index+a[0].length])}x.push(...t)}const y=[...g,...f,...x];if(!y.length)return[];const d=y.sort((e,t)=>e[0]-t[0]),s=[d[0]];for(let e=1;e<d.length;e++){const[t,a]=d[e],c=s[s.length-1];c[1]>=t?c[1]=Math.max(c[1],a):s.push(d[e])}return[n.slice(0,s[0][0]),...s.map(([e,t],a)=>p.jsxs(z.Fragment,{children:[p.jsx("mark",{children:n.slice(e,t)}),s[a+1]?n.slice(t,s[a+1][0]):void 0]},`${e}:${t}`))]},[n,i]),O="_highlightArea_4i7ca_1",W={highlightArea:O},b=o.forwardRef(({highlights:n,onChange:i,onScroll:g,...l},h)=>{var _,k;const[f,x]=o.useState(String(l.value||l.defaultValue||"")),[y,d]=o.useState(),s=o.useRef(null),e=P(h),t=C(f,n),a=o.useCallback(r=>{x(r.target.value),i&&i(r)},[i]),c=o.useCallback(r=>{if(s!=null&&s.current){const u=r.target;s.current.scrollLeft=u.scrollLeft,s.current.scrollTop=u.scrollTop}g&&g(r)},[g]),w=o.useCallback(r=>{if(s!=null&&s.current&&r){const u=r.borderBoxSize[0].inlineSize,T=r.borderBoxSize[0].blockSize;s.current.style.width=`${u}px`,s.current.style.height=`${T}px`}},[]),V=o.useCallback(()=>{const r=window.getComputedStyle(e.current),u={font:r.getPropertyValue("font"),letterSpacing:r.getPropertyValue("letter-spacing"),whiteSpace:r.getPropertyValue("white-space"),padding:r.getPropertyValue("padding"),border:r.getPropertyValue("border"),wordWrap:r.getPropertyValue("word-wrap"),verticalAlign:r.getPropertyValue("vertical-align"),textIndent:r.getPropertyValue("text-indent")};d(u)},[e]);return o.useEffect(()=>{if(e.current){V();const r=new ResizeObserver(u=>w(u[0]));return r.observe(e.current),()=>{r.disconnect()}}},[e,w,V]),p.jsxs(p.Fragment,{children:[p.jsx("span",{ref:s,style:{...l.style,...y,backgroundColor:((_=l.style)==null?void 0:_.backgroundColor)||"#fff",background:(k=l.style)==null?void 0:k.background},className:W.highlightArea,"aria-hidden":!0,children:t}),p.jsx("textarea",{ref:e,onChange:a,onScroll:c,...l,style:{...l.style,background:"transparent",position:"relative",zIndex:1}})]})});b.displayName="TextareaWithHighlights";try{b.displayName="TextareaWithHighlights",b.__docgenInfo={description:"",displayName:"TextareaWithHighlights",props:{highlights:{defaultValue:null,description:"",name:"highlights",required:!1,type:{name:"HighlightType | HighlightType[]"}}}}}catch{}const S=j({length:5}).join(`

`),$={component:b,args:{defaultValue:S,highlights:[[S.indexOf(" ")+1,S.indexOf(".")+1],"a"],style:{width:"100%",height:"200px"}},argTypes:{highlights:{description:"One or multiple strings, regular expressions, and/or arrays with the range `[from, to]`"},defaultValue:{table:{disable:!0}},style:{table:{disable:!0}}},parameters:{docs:{description:{component:"A textarea with highlights."}}}},m={args:{}};var H,R,A;m.parameters={...m.parameters,docs:{...(H=m.parameters)==null?void 0:H.docs,source:{originalSource:`{
  args: {}
}`,...(A=(R=m.parameters)==null?void 0:R.docs)==null?void 0:A.source}}};const F=["Default"];export{m as Default,F as __namedExportsOrder,$ as default};
