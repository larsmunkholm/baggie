import{H as V}from"./index-Ql3JdUw3.js";import{j as f}from"./jsx-runtime-T-AYSyta.js";import{r as o,R as k}from"./index-Q-IP07kC.js";import"./_commonjsHelpers-1J56E-h6.js";const j=(n,l=null)=>{const g=o.useRef(l);return o.useEffect(()=>{if(n)if(typeof n=="function"){n(g.current);return}else n.current=g.current}),g},z=(n,l)=>o.useMemo(()=>{if(!l)return[];const{ranges:g,regexes:i,strings:h}=(Array.isArray(l)?typeof l[0]=="number"?[l]:l:[l]).reduce((e,t)=>(typeof t=="string"?e.strings.push(t):Array.isArray(t)&&typeof t[0]=="number"&&typeof t[1]=="number"?e.ranges.push(t):t instanceof RegExp&&e.regexes.push(t),e),{ranges:[],regexes:[],strings:[]});if(!g.length&&!i.length&&!h.length)return[];const p=[];for(let e=0;e<h.length;e++){let t=-1;for(;(t=n.indexOf(h[e],t+1))>=0;)p.push([t,t+h[e].length])}const x=[];for(let e=0;e<i.length;e++){const t=[];if(i[e].global){let a=-1,c;for(;(c=i[e].exec(n))!==null&&(!t.length||c.index>t[a][0]);)t.push([c.index,c.index+c[0].length]),a++}else{const a=i[e].exec(n);a&&t.push([a.index,a.index+a[0].length])}x.push(...t)}const y=[...g,...p,...x];if(!y.length)return[];const d=y.sort((e,t)=>e[0]-t[0]),s=[d[0]];for(let e=1;e<d.length;e++){const[t,a]=d[e],c=s[s.length-1];c[1]>=t?c[1]=Math.max(c[1],a):s.push(d[e])}return[n.slice(0,s[0][0]),...s.map(([e,t],a)=>f.jsxs(k.Fragment,{children:[f.jsx("mark",{children:n.slice(e,t)}),s[a+1]?n.slice(t,s[a+1][0]):void 0]},`${e}:${t}`))]},[n,l]),P="_highlightArea_4i7ca_1",C={highlightArea:P},R=o.forwardRef(({highlights:n,onChange:l,onScroll:g,...i},h)=>{const[p,x]=o.useState(String(i.value||i.defaultValue||"")),[y,d]=o.useState(),s=o.useRef(null),e=j(h),t=z(p,n),a=o.useCallback(r=>{x(r.target.value),l&&l(r)},[l]),c=o.useCallback(r=>{if(s?.current){const u=r.target;s.current.scrollLeft=u.scrollLeft,s.current.scrollTop=u.scrollTop}g&&g(r)},[g]),S=o.useCallback(r=>{if(s?.current&&r){const u=r.borderBoxSize[0].inlineSize,A=r.borderBoxSize[0].blockSize;s.current.style.width=`${u}px`,s.current.style.height=`${A}px`}},[]),w=o.useCallback(()=>{const r=window.getComputedStyle(e.current),u={font:r.getPropertyValue("font"),letterSpacing:r.getPropertyValue("letter-spacing"),whiteSpace:r.getPropertyValue("white-space"),padding:r.getPropertyValue("padding"),border:r.getPropertyValue("border"),wordWrap:r.getPropertyValue("word-wrap"),verticalAlign:r.getPropertyValue("vertical-align"),textIndent:r.getPropertyValue("text-indent")};d(u)},[e]);return o.useEffect(()=>{if(e.current){w();const r=new ResizeObserver(u=>S(u[0]));return r.observe(e.current),()=>{r.disconnect()}}},[e,S,w]),f.jsxs(f.Fragment,{children:[f.jsx("span",{ref:s,style:{...i.style,...y,backgroundColor:i.style?.backgroundColor||"#fff",background:i.style?.background},className:C.highlightArea,"aria-hidden":!0,children:t}),f.jsx("textarea",{ref:e,onChange:a,onScroll:c,...i,style:{...i.style,background:"transparent",position:"relative",zIndex:1}})]})});R.displayName="TextareaWithHighlights";const b=V({length:5}).join(`

`),T={component:R,args:{defaultValue:b,highlights:[[b.indexOf(" ")+1,b.indexOf(".")+1],"a"],style:{width:"100%",height:"200px"}},argTypes:{highlights:{description:"One or multiple strings, regular expressions, and/or arrays with the range `[from, to]`"},defaultValue:{table:{disable:!0}},style:{table:{disable:!0}}},parameters:{docs:{description:{component:"A textarea with highlights."}}}},m={args:{}};m.parameters={...m.parameters,docs:{...m.parameters?.docs,source:{originalSource:`{
  args: {}
}`,...m.parameters?.docs?.source}}};const W=["Default"];export{m as Default,W as __namedExportsOrder,T as default};
